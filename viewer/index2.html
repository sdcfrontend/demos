<!DOCTYPE html>
<html lang="en" class="">
  
<head>

  <meta name="viewport" id="viewport" content="width=device-width,maximum-scale=1,minimum-scale=1,minimal-ui">

  <style>
  
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    font-family: sans-serif;
    min-height: 3000px;
  }
  
  .view {
    position: relative
  }
  
  .view-frame {
    background: #eee;
    min-width: 500px;
    position: relative;
    left: 50%;
    transform: translateX(-50%)
  }
  
  .view-image {
    width: 100%;
  }

  .view-overlay {
    position: absolute;
    min-width: 320px;
    width: 64%;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    height: 100%;
  }

  .view-caption {
    background: #e3f6f8;
    color: black;
    padding: 18px;
    position: absolute;
    z-index: 11;
    line-height: 1.4;
    margin: 24px 0 0 -24px;
    width: 300px;
    visibility: hidden;
    opacity: 0;
    filter: drop-shadow(1px 2px 1px rgba(0, 0, 0, 0.288));
  }

  .view-spot {
    width: 20px;
    height: 20px;
    background: rgba(255, 0, 0, 0.897);
    border: 2px solid white;
    filter: drop-shadow(1px 1px 2px rgba(0, 0, 0, 0.288));
    border-radius: 50%;
    position: absolute;
    z-index: 10;
    transform: translate(-50%,-50%);
    cursor: pointer;
  }

  .view-spot--open + .view-caption {
    visibility: visible;
    opacity: 1;
  }

  .view-spot--open:after {
    content: "";
    position: absolute;
    width: 10px;
    height: 10px;
    background: #e3f6f8;
    transform: rotate(45deg);
    top: calc(11px + 100%);
    z-index: 11;
    left: calc(50% - 5px);
  }

  @media all and (max-width: 600px){
    .view-caption {
      left: 50%!important;
      transform: translate(-50%,0);
      margin-left: 0!important;
      width: 100%;
    }
  }

</style>
  
</head>
  <body>
  <div class="view">
    <div class="view-frame">
        <div class="view-overlay" data-role="overlay">
            <a href="#" class="view-spot" style="left: 49.2325%; top: 32.1429%;"></a><div class="view-caption"><h3>Eye</h3><p>The organisation’s charitable trust has two joint chairmen: Bruce Ritchie, a Mayfair property developer who founded Residential Land, and David Meller, from the luxury good specialist Meller Group, who also sits on the board of the Department for Education and the Mayor’s Fund for London.</p></div><a href="#" class="view-spot" style="left: 52.6316%; top: 38.0252%;"></a><div class="view-caption"><h3>Nose</h3><p>The organisation’s charitable trust has two joint chairmen: Bruce Ritchie, a Mayfair property developer who founded Residential Land, and David Meller, from the luxury good specialist Meller Group, who also sits on the board of the Department for Education and the Mayor’s Fund for London.</div><a href="#" class="view-spot" style="left: 40.5702%; top: 51.313%;"></a><div class="view-caption"><h3>Mouth</h3><p>The organisation’s charitable trust has two joint chairmen: Bruce Ritchie, a Mayfair property developer who founded Residential Land, and David Meller, from the luxury good specialist Meller Group, who also sits on the board of the Department for Education and the Mayor’s Fund for London.</div><a href="#" class="view-spot" style="left: 26.0965%; top: 45.6933%;"></a><div class="view-caption"><h3>Ear</h3><p>The organisation’s charitable trust has two joint chairmen: Bruce Ritchie, a Mayfair property developer who founded Residential Land, and David Meller, from the luxury good specialist Meller Group, who also sits on the board of the Department for Education and the Mayor’s Fund for London.</div><a href="#" class="view-spot" style="left: 50%; top: 63.7605%;"></a><div class="view-caption"><h3>Hand</h3><p>The organisation’s charitable trust has two joint chairmen: Bruce Ritchie, a Mayfair property developer who founded Residential Land, and David Meller, from the luxury good specialist Meller Group, who also sits on the board of the Department for Education and the Mayor’s Fund for London.</div><a href="#" class="view-spot" style="left: 98.9035%; top: 65.1261%;"></a><div class="view-caption"><h3>Tail</h3><p>The organisation’s charitable trust has two joint chairmen: Bruce Ritchie, a Mayfair property developer who founded Residential Land, and David Meller, from the luxury good specialist Meller Group, who also sits on the board of the Department for Education and the Mayor’s Fund for London.</div><a href="#" class="view-spot" style="left: 78.3991%; top: 50.7353%;"></a><div class="view-caption"><h3>Belly</h3><p>The organisation’s charitable trust has two joint chairmen: Bruce Ritchie, a Mayfair property developer who founded Residential Land, and David Meller, from the luxury good specialist Meller Group, who also sits on the board of the Department for Education and the Mayor’s Fund for London.</div></div>
      <img class="view-image" src="https://e3.365dm.com/18/01/768x1024/skynews-clones-monkey-china_4214099.jpg?bypass-service-worker&20180124234456" alt="">
    </div>

  </div>

  <script>
    var overlay = document.querySelector('[data-role="overlay"]');
    var dots = document.querySelectorAll('.view-spot');
    var caption = document.querySelectorAll('.view-caption');

    dots.forEach(function(dot, index){
      dot.onclick = function(event){
        event.preventDefault();
        positionCaption(event, dot, caption[index], overlay);
      }
    })

    // overlay.onclick = function(e){
      
    //   if(e.target.className.match(/view-spot/)){
    //     return;
    //   }

    //   var width = overlay.offsetWidth;
    //   var height = overlay.offsetHeight;

    //   var x = e.offsetX;
    //   var y = e.offsetY;

    //   var dot = document.createElement('a');
    //   dot.href = "#";
    //   dot.className = 'view-spot';
    //   dot.style.cssText = "left:"+toPercent(x, width)+"%;top:"+toPercent(y, height)+"%";

    //   var caption = document.createElement('div');
    //   caption.className = 'view-caption';
    //   caption.textContent = "The organisation’s charitable trust has two joint chairmen: Bruce Ritchie, a Mayfair property developer who founded Residential Land, and David Meller, from the luxury good specialist Meller Group, who also sits on the board of the Department for Education and the Mayor’s Fund for London.";

    //   if(e.target.className.match(/view-spot/)){
    //     overlay.removeChild(e.target);
    //   }
    //   else {
    //     overlay.appendChild(dot);
    //     overlay.appendChild(caption); 
    //     dot.onclick = function(event){
    //       event.preventDefault();
    //       positionCaption(event, dot, caption, overlay);
    //     }
    //   }  
    // }

    function toPercent(value, total){
      return (100/total)*value;
    }

    function toPercentConstraint(value, parent, caption){
      var left = value;
      var dims = parent.getBoundingClientRect();
      var offset = (caption.offsetWidth + value) - dims.width;
      var marginLeft = window.getComputedStyle(caption, null).getPropertyValue('margin-left');
      marginLeft = Number(marginLeft.replace('px', ''));
      
      if(offset > 0){
        if((dims.width - left) < Math.abs(marginLeft)){
          left += Math.abs(marginLeft);
        };
        left = left - offset;
      }

      return toPercent(left, dims.width);
    }

    function positionCaption(event, dot, caption, overlay){

      document.querySelectorAll('.view-spot').forEach(function(item){
        if(item!==dot){
          item.classList.remove('view-spot--open');
        }
      });

      dot.classList.toggle('view-spot--open');

      if(dot.classList.contains('view-spot--open')){
        center(dot);
      }

      var x = event.target.offsetLeft;
      var y = event.target.offsetTop;
      caption.style.cssText = "left:"+toPercentConstraint(x, overlay, caption)+"%;top:"+toPercent(y, overlay.offsetHeight)+"%"; 
    }

    function center(el){
      var dims = el.getBoundingClientRect();
      var y = window.pageYOffset;
      var screeny = window.innerHeight;
      var top = dims.top;
      
      window.scrollTo(0, (y + top) - (screeny/3));
    }
  </script>
  </body>
  </html>
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link rel="stylesheet" href="output.css">
    <style media="screen">

      html {
        scroll-behavior: initial;
      }
      body {
        height: 600vh;
      }
      .pages {
        white-space: nowrap;
        overflow: auto;
        scroll-behavior: smooth;
        width: 100%;
        height: 100vh;
        -webkit-scroll-snap-points-x: repeat(100vw);
        -webkit-scroll-snap-type: mandatory;
        scroll-snap-points-x: repeat(100vw);
        scroll-snap-type: mandatory;
        position: fixed;
        overflow-y: hidden;
      }

      .page {
        width: 100vw;
        height: 100%;
        display: inline-block;
        position: relative;
      }

      .page__body {
        background: rgba(0,0,0,0.7);
        position: absolute;
        bottom: 20px;
        max-width: 50%;
        right: 50%;
        transform: translateX(50%);
        padding: 30px 36px 10px;
        color: white;
        z-indeX: 4;
        white-space: normal;
      }

      .page__body h2 {
        font-size: 2.2em;
        margin-bottom: 0.3em;
        font-weight: 400;
      }

      .page img {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        object-fit: cover;
        object-position: center;
        display: block;
      }

      nav {
        color: white;
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 2;
      }

      nav a {
        display: inline-block;
        background: #777;
        padding: 4px;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        margin: 3px 1px;
        color: transparent
      }

      nav a[aria-current]{
        background: white;
      }

      shim {
        height: 100vw;
        background: limegreen;
        border: 3px solid green;
        width: 100%;
        display: block;
      }


      @media all and (max-width: 600px){
        .page__body {
          max-width: 90%;
          width: 90%;
          left: 5%;
          padding: 20px;
          transform: none;
        }

        .page__body h2 {
          font-size: 1.9em
        }

        nav a {
          
          width: 19px;
          height: 19px;
          margin: 2px 1px;
          
        }
      }

    </style>
  </head>
  <body>
    <nav>
      <a href="#" data-index="0" aria-current="true">1</a>
      <a href="#" data-index="1">2</a>
      <a href="#" data-index="2">3</a>
      <a href="#" data-index="3">4</a>
      <a href="#" data-index="4">5</a>
      <a href="#" data-index="5">6</a>
    </nav>
    <div class="pages">

      <div class="page" data-index="0">
        <div class="page__body">
          <h2>A big news story goes here</h2>
          <p>I am alone, and feel the charm of existence in this spot, which was created for the bliss of souls like mine.</p>
        </div>
      <img src="https://e3.365dm.com/17/11/2048x1152/skynews-theresa-may-priti-patel_4149855.jpg?20171108012646" alt=""></div><div class="page" data-index="1"><div class="page__body">
        <h2>A big news story goes here</h2>
        <p>I am alone, and feel the charm of existence in this spot, which was created for the bliss of souls like mine.</p>
      </div><img src="https://e3.365dm.com/17/06/2048x1152/1db47ea208b59cc44a53d6419ee13eaa55c21809ff9f4e41235d88538fb7c024_3982084.jpg?20170620154937" alt=""></div><div class="page" data-index="2"><div class="page__body">
        <h2>A big news story goes here</h2>
        <p>I am alone, and feel the charm of existence in this spot, which was created for the bliss of souls like mine.</p>
      </div><img src="https://e3.365dm.com/17/11/2048x1536/skynews-priti-patel-cabinet-minister_4150609.jpg?20171109130402" alt=""></div><div class="page" data-index="3"><div class="page__body">
        <h2>A big news story goes here</h2>
        <p>I am alone, and feel the charm of existence in this spot, which was created for the bliss of souls like mine.</p>
      </div><img src="https://e3.365dm.com/17/11/2048x1152/skynews-gary-goldsmith-uncle-kate-middleton_4155444.jpg?20171114122331" alt=""></div><div class="page" data-index="4"><div class="page__body">
        <h2>A big news story goes here</h2>
        <p>I am alone, and feel the charm of existence in this spot, which was created for the bliss of souls like mine.</p>
      </div><img src="https://e3.365dm.com/17/11/2048x1152/skynews-vladimir-putin-moscow-tv-interview_4155492.jpg?20171114131313" alt=""></div><div class="page" data-index="5"><div class="page__body">
        <h2>A big news story goes here</h2>
        <p>I am alone, and feel the charm of existence in this spot, which was created for the bliss of souls like mine.</p>
      </div><img src="https://e3.365dm.com/17/11/2048x1152/skynews-cash-money-sterling_4156288.jpg?20171115094120" alt=""></div>
    </div>
    <shim data-index="0"></shim>
    <shim data-index="1"></shim>
    <shim data-index="2"></shim>
    <shim data-index="3"></shim>
    <shim data-index="4"></shim>
    <shim data-index="5"></shim>
<script>

NodeList.prototype.forEach = Array.prototype.forEach;
var con = document.querySelector('.pages');
var pages = document.querySelectorAll('.page');
var navitems = document.querySelectorAll('nav a');
var shims = document.querySelectorAll('shim');

var current = 0;

var timeout;

con.onscroll = function(){

  clearTimeout(timeout);
  timeout = setTimeout(function(){

    requestAnimationFrame(function(){
      var match = 0;
      pages.forEach(function(page, index){
        if(page.getBoundingClientRect().left < (con.offsetWidth/2)){
          match = index;
        }
      })
      window.scrollTo(0, match*shims[0].offsetHeight);

    })

  }, 300);

}

function setNav(index){

  navitems.forEach(function(item){
    item.removeAttribute('aria-current');
  });

  navitems[index].setAttribute('aria-current', true);
}

function scrollListener(){

  function tick(){

    var match = 0;
    var shim = 0;
    pages.forEach(function(page, index){
      if(page.getBoundingClientRect().left < (con.clientWidth/2)){
        match = index
      }
    })

    requestAnimationFrame(tick);
  }

  tick();
}

function setScrollPosition(index){
  if(current === index){
    return;
  }

  current = index;
  setNav(current);
  var width = pages[0].offsetWidth;
  var height = shims[0].offsetHeight;
  var left = (width*index);
  con.scrollLeft = left;
}

function navClicks(){
  navitems.forEach(function(item){
    item.onclick = function(e){
      e.preventDefault();
      window.scrollTo(0, (shims[0].offsetHeight * parseInt(this.getAttribute('data-index'), 10)));
    }
  })
}

function pageScroll(){

  var match = 0;

  function tick(){

    shims.forEach(function(shim, index){
      if(shim.getBoundingClientRect().top < (window.innerHeight/2)){
        match = index;
      }
    });

    setScrollPosition(match);
    requestAnimationFrame(tick);

  }

  tick();
}

// scrollListener();
navClicks();
pageScroll();

</script>
  </body>
</html>
